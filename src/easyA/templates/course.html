<!doctype html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="StyleSheet" href="{{ url_for('static', filename='course.css') }}" />
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/6b9101bbf3.js" crossorigin="anonymous"></script>
  <title>easyA - {{ course_id }}</title>
</head>
<body>
  <!-- class="fixed-top" -->
  <div id="class-header">
    <div class="container mb-0" >
      <div id="row1" class="row  my-3">
        <div class="col-3">
          <div class="container text-center">
            <a href="{{ url_for('index') }}" id="logo">easy<span>A</span></a>
          </div>
        </div>
        <div class="col-6">
          <div id="cover">
            <form method="get" action="#" id="search_bar_form" onsubmit="return validateSearch()">
              <div class="tb">
                <div class="td">
                  <input id="search_bar" type="text" placeholder="Search" required>
                </div>
                <div class="td" id="s-cover">
                  <button id=submit_btn type="submit">
                    <div id="s-circle"></div>
                    <span></span>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="col-3">
          {% if 'email' in session %}
          <div class="btn-group">
            <button id="user" type="button" class="btn btn-outline-warning mx-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-user-circle"></i> {{ session['email'] }}</button>
            <div class="dropdown-menu pull-right">
              <a class="dropdown-item" href="{{ url_for('reset_pwd') }}">Password Change</a>
              <a class="dropdown-item"  onclick="window.location.href = '{{ url_for('signout') }}';">Log Out</a>
            </div>
          </div>
          {% else %}
          <button id="login_check2" onclick="window.location.href = '{{ url_for('login') }}';" type="button" class="btn btn-outline-light mx-2">Log in</button>
          <button id="login_check3" onclick="window.location.href = '{{ url_for('signup') }}';" type="button" class="btn btn-outline-warning mx-2">Sign up</button>
          {% endif %}
        </div>
      </div>
      <div id='row2' class="row">
        <div class="col-6">
          <div class="container text-right">
            <h1 id="name">{{ course_id }}</h1>
          </div>
        </div>
        <div class="col-6 align-items-end m-0">
          <h2 class="align-bottom">{{ course_name }}</h2>
          <p class="align-bottom">{{ description }}</p>
        </div>
      </div>
      <div id='row3' class="row">
        <div class="col-6 text-right">
          <h3>
            {%for i in range(0, rating)%}
            <i class="fas fa-star"></i>
            {%endfor%}
            {%for i in range(0, (5 - rating))%}
            <i class="far fa-star"></i>
            {%endfor%}
          </h3>
          <h4>Based on {{ rating_count }} ratings.</h4>
        </div>
        <div class="col-6">
          <button id="review_button" onclick="window.location.href = '/course/{{course_id}}/new_review';" type="button" class="btn btn-light">Write a review</button>
        </div>
      </div>
      <div id='row4' class="row">
        <div class="col-6">
          <p class="align-bottom">Student Reviews</p>
        </div>
        <div class="col-6  text-right">
          <div class="btn-group">
            <button type="button" class="border-0 btn btn-outline-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Filter <i class="fas fa-filter"></i></button>
            <div class="dropdown-menu dropdown-menu-right">
              <div class="form-group">
                <label for="sort">Sort by</label>
                <select class="form-control" id="sort">
                  <option>Chronological</option>
                  <option>Upvotes</option>
                </select>
              </div>
              <div class="form-group">
                <label for="proffesor">Proffesor</label>
                <select class="form-control" id="proffesor">
                  {% for professor in professors %}
                  <option>{{ professor['professor_name'] }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
                <label class="form-check-label" for="defaultCheck1">Tag</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr>
  </div>
  <ul>
    {%for post in user_posts%}
    {%if not post['text'] or post['text'].isspace()%}
    <li>
      <div class="container review d-flex">
        <div class="row">
          <div class="col-6">
            <p class="review-professor"><span>Author:</span> You</p>
          </div>
          <div class="col-6 text-right">
            <p class="review-date text-right"><span>{{ post['posted_date'] }}</span></p>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <p class="text">
              {%for i in range(0, post['rating'])%}
              <i class="fas fa-star"></i>
              {%endfor%}
              {%for i in range(0, (5 - post['rating']))%}
              <i class="far fa-star"></i>
              {%endfor%}
            </p>
          </div>
          <div class="col-6 text-right">
            <form action="{{ url_for('delete_review') }}" method="POST">
              <input name="post_ID" type="hidden" value="{{ post['post_ID'] }}"></input>
              <button type="submit" class="btn btn-warning">Delete</button>
            </form>
          </div>
        </div>
      </div>
    </li>
    {%endif%}
    {%endfor%}
    {%for post in posts%}
    <li>
      <div class="container review">
        <div class="d-flex justify-content-end">
          <div class="btn-group">
            <button type="button" class="btn btn-outline-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
            <div class="dropdown-menu dropdown-menu-right">
              <!-- <button class="dropdown-item" type="button">Share</button> -->
              <!-- We have not implemented sharing posts yet (sprint 3) -->
              {%if post in user_posts%}
              <form action="{{ url_for('delete_review') }}" method="POST">
                <input name="post_ID" type="hidden" value="{{ post['post_ID'] }}"></input>
                <button type="submit" class="dropdown-item">Delete</button>
              </form>
              {%else%}
              <form action="{{ url_for('contact') }}" method="POST">
                <input name="post_ID" type="hidden" value="{{ post['post_ID'] }}"></input>
                <button type="submit" class="dropdown-item">Contact</button>
              </form>
              <form action="{{ url_for('report') }}" method="POST">
                <input name="post_ID" type="hidden" value="{{ post['post_ID'] }}"></input>
                <button type="submit" class="dropdown-item">Report</button>
              </form>
              {%endif%}
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-8">
            {% if post in user_posts %}
            <p class="review-professor"><span>Author:</span> You</p>
            {% else %}
            <p class="review-professor"><span>Author:</span> A Purdue Student</p>
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="col-8">
            <p class="review-professor"><span>Professor:</span>  {{ post['professor'] }}</p>
          </div>
          <div class="col text-right">
            <p class="review-date text-right"><span>{{ post['posted_date'] }}</span></p>
          </div>
        </div>
        <p class="review-tags"> <span>Attendance:</span> {{ post['attendance'] }} <span>Textbook:</span> {{ post['textbook'] }} <span>Grade:</span> {{ post['grade'] }}</p>
        <p class="review-body">{{ post['text'] }}</p>
        <div class="row">
          <div class="col-6">
            <button type="button" name="button" class="review-votes upvote mx-2"><i class="fas fa-arrow-up"></i>{{ post['upvotes'] }}</button>
            <button type="button" name="button" class="review-votes downvote mx-2"><i class="fas fa-arrow-down"></i>{{ post['downvotes'] }}</button>
          </div>
          <div class="col-6 text-right">

            <p class="text-right">
              {%for i in range(0, post['rating'])%}
              <i class="fas fa-star"></i>
              {%endfor%}
              {%for i in range(0, (5 - post['rating']))%}
              <i class="far fa-star"></i>
              {%endfor%}
            </p>
          </div>
        </div>
      </div>
    </li>
    {%endfor%}
  </ul>
  <!-- Optional JavaScript -->
  <script src="{{ url_for('static', filename='course.js') }}"></script>
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>
